
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Agenda Programa Música na Rede</title>
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #fff;
    }

    h2 {
      text-align: center;
      color: #5d2f86;
    }

    #calendar {
      max-width: 1000px;
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <h2>Agenda Programa Música na Rede</h2>
  <div id="calendar"></div>

  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      fetch("https://script.google.com/macros/s/AKfycbx4yPljr3TaRFIyEmpLN-JS_GZmXUSZM0ftWbZumQ_uVl6Tf8ZS6mDqmuhYBWLEB6zW/exec")
        .then(response => response.json())
        .then(events => {
          const calendarEl = document.getElementById('calendar');
          const calendar = new FullCalendar.Calendar(calendarEl, {
            locale: 'pt-br',
            initialView: 'dayGridMonth',
            headerToolbar: {
              left: 'prev,next today',
              center: 'title',
              right: 'dayGridMonth,listMonth'
            },
            events: events,
            eventClick: function(info) {
              const e = info.event.extendedProps;
              alert(
                `🎵 ${info.event.title}

` +
                `📅 Data: ${info.event.start.toLocaleString()}
` +
                `📍 Local: ${e["Local"] || "-"}
` +
                `🏫 Grupo: ${e["Grupo de Referência"] || "-"}
` +
                `📁 Projeto: ${e["Projeto (Dono do Evento)"] || "-"}`
              );
            }
          });
          calendar.render();
        });
    });
  </script>
</body>
</html>
